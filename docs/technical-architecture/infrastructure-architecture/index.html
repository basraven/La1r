<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Infrastructure Architecture"><meta property="og:title" content><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://la1r.com/docs/technical-architecture/infrastructure-architecture/"><title>Infrastructure Architecture | La1r</title><link rel=icon href=/favicon.ico type=image/x-icon><link rel=stylesheet href=/book.min.9d4a50a3f8215d92699ad8fffed3f7e077b3115be0ead58de83527db7f5ce38c.css integrity="sha256-nUpQo/ghXZJpmtj//tP34HezEVvg6tWN6DUn239c44w="><script defer src=/en.search.min.20eaec157776cd7379bf25daa64cb18e95f8afcbd2220a60ae99008f08c031db.js integrity="sha256-IOrsFXd2zXN5vyXapkyxjpX4r8vSIgpgrpkAjwjAMds="></script><link rel=alternate type=application/rss+xml href=https://la1r.com/docs/technical-architecture/infrastructure-architecture/index.xml title=La1r></head><body><input type=checkbox class=hidden id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><h2 class=book-brand><a href=https://la1r.com/><span class=brand-title>| &nbsp;&nbsp;La1r</span><img src=/svg/lair-icon-dark.svg alt=Logo></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul class=pre-inject-menu><li><strong><a href=/>La1r</a></strong></li></ul><ul><li><a href=/docs/capability-architecture/>Capability Architecture</a><ul><li><a href=/docs/capability-architecture/event-specifications/>Event Specifications</a><ul></ul></li><li><a href=/docs/capability-architecture/governance-catalogs/>Governance Catalogs</a><ul></ul></li></ul></li><li><a href=/docs/technical-architecture/>Technical Architecture</a><ul><li><a href=/docs/technical-architecture/application-architecture/>Application Architecture</a></li><li><a href=/docs/technical-architecture/data-architecture/>Data Architecture</a><ul></ul></li><li><a href=/docs/technical-architecture/infrastructure-architecture/ class=active>Infrastructure Architecture</a><ul><li><a href=/docs/technical-architecture/infrastructure-architecture/deployment-architecture/>Deployment Architecture</a></li><li><a href=/docs/technical-architecture/infrastructure-architecture/storage-architecture/>Storage Architecture</a><ul></ul></li><li><a href=/docs/technical-architecture/infrastructure-architecture/network-architecture/>Network Architecture</a></li></ul></li><li><a href=/docs/technical-architecture/operations-architecture/>Operations Architecture</a></li><li><a href=/docs/technical-architecture/security-architecture/>Security Architecture</a></li></ul></li><li><a href=/docs/planning/>Planning</a><ul></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class="flex align-center justify-between book-header"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Infrastructure Architecture</strong></header><article class=markdown><h2 id=infrastructure-architecture>Infrastructure Architecture</h2><p>The infrastructure setup is one of the biggest topics of this project in terms of size and complexity.</p><blockquote><p>TODO: Infrastructure Arch Diagram</p></blockquote><h3 id=how-its-made>How its made</h3><p>How all of this infrastructure is deployed can be found in [the deployment architecture].</p><h3 id=server-inventory>Server Inventory</h3><p>Currently the following servers are being used:</p><table><thead><tr><th>ID</th><th>Hostname</th><th>OS</th><th>Hardware Description</th></tr></thead><tbody><tr><td>1</td><td>linux-wayne</td><td>Ubuntu server (latest)</td><td>Core i5 Desktop with SSD</td></tr><tr><td>2</td><td>50centos</td><td>CentOS 8</td><td>Core i7 Laptop with HDD only</td></tr></tbody></table><h3 id=kubernetes-k8s>Kubernetes (k8s)</h3><p>The majority of the applications are hosted through Kubernetes.
K8s can be implemented in a million different ways. The implementation on La1r follows a few principles:</p><ul><li>K8s should run on bare metal only - it should not be dependent on any cloud resource, this includes function-as-service (FaaS) implementations such as AWS Lambda.</li><li>Vanilla k8s should be used - flavored variants of k8s take some controls away from the sys admin and introduce (sometimes unwanted) abstractions.</li><li>The latest k8s version should be used - this to incentive application of new k8s capabilities</li><li>Template engines, package managers and operators such as helm are not used - this again takes away a lot of control from the sys admin which takes away the learning experience, thus the fun.</li><li>K8s over bare metal - since the use of k8s incentives portability of applications, the default hosting approach should be on k8s not on the bare metal server itself (for example through Ansible). Only things that really make sense or are directly needed by the cluster itself, such as OpenVpn, can be implemented directly on the server with Ansible.</li></ul><h4 id=init-with-kubeadm>Init with kubeadm</h4><p>Since we&rsquo;re using vanilla k8s on bare metal but we do not have all the time in the world, the decision was made to use kubeadm to initialize the cluster and manage node cluster and upgrades. Several upgrades were already performed with this which went flawless, even with multi cpu (x86 and arm7) architecture environments.</p><h4 id=node-agnostic-storage-coming-soon>Node agnostic storage (coming soon)</h4><p>Storage is often a difficult topic with k8s bare metal clusters, since the entire aim of k8s is to be independent and decoupled from infrastructure. This is why the current plan is to migrate all storage used by the cluster to a storage abstraction service, creating node agnostic storage facilities everywhere on the k8s cluster. The currently plan is to achieve this with Ceph through Rook.io, which also is an exception on the non-operator application architecture principle as mentioned earlier</p><h4 id=reverse-proxy-with-dmz-ed-online-exposure>Reverse proxy, with dmz-ed online exposure</h4><p>Traefik is used as reverse proxy for all default traffic, this because it easily integrates with k8s and it provides a fancy dashboard UI, and maybe because I&rsquo;m traefik 2.0 contributor&mldr;
Here my personal preference is to not follow the custom resource definition (CRD) hype and just use standard ingress objects, also for possible portability reasons if I ever get sick of traefik.</p><h3 id=network-architecture>Network Architecture</h3><p>Since the network architecture of the project is not straight-forward, it is handled with several applications, all making a single cluster.
<a href=./network-architecture/>Read more</a></p></article><div class="book-footer justify-between"><div><a class="flex align-center" href=https://github.com/basraven/la1r/commit/b462b5b78535731393d03c8d77cdfc9506a88834 title="Last modified by Sebastiaan Raven | Aug 13, 2020" target=_blank><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Aug 13, 2020</span></a></div></div></div><aside class="book-toc levels-true fixed"><nav id=TableOfContents><ul><li><ul><li><a href=#infrastructure-architecture>Infrastructure Architecture</a><ul><li><a href=#how-its-made>How its made</a></li><li><a href=#server-inventory>Server Inventory</a></li><li><a href=#kubernetes-k8s>Kubernetes (k8s)</a></li><li><a href=#network-architecture>Network Architecture</a></li></ul></li></ul></li></ul></nav></aside></main></body></html>